<?xml version="1.0" encoding="utf-8" ?>
<!--
  Trimmer descriptor to preserve WPF DirectWrite COM interop types.

  The IL trimmer strips COM marshalling code used by WPF's font rendering system.
  This file tells the trimmer to preserve critical types in PresentationCore
  that are required for FontFamily/DirectWrite functionality.
-->
<linker>
  <!-- Preserve all of PresentationCore - it has extensive internal COM usage for DirectWrite -->
  <assembly fullname="PresentationCore" preserve="all" />

  <!-- DirectWriteForwarder is a C++/CLI assembly that bridges to DirectWrite COM interfaces -->
  <assembly fullname="DirectWriteForwarder" preserve="all" />

  <!-- WindowsBase contains DependencyObject and other core WPF types -->
  <assembly fullname="WindowsBase" preserve="all" />

  <!-- PresentationFramework contains XAML and control types that use reflection -->
  <assembly fullname="PresentationFramework" preserve="all" />

  <!-- System.Xaml is required for XAML parsing and type resolution -->
  <assembly fullname="System.Xaml" preserve="all" />

  <!-- Preserve COM interop infrastructure in CoreLib -->
  <assembly fullname="System.Private.CoreLib">
    <!-- Preserve COM marshalling infrastructure -->
    <type fullname="System.Runtime.InteropServices.Marshal" preserve="all" />
    <type fullname="System.Runtime.InteropServices.ComTypes.*" preserve="all" />
    <type fullname="System.Runtime.InteropServices.ComWrappers" preserve="all" />

    <!-- Preserve activation types used by COM -->
    <type fullname="System.Activator" preserve="all" />
    <type fullname="System.RuntimeType" preserve="all" />
  </assembly>
</linker>
